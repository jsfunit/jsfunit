<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html 
PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
"DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core">
  
  <ui:composition template="layout.xhtml">
    <ui:define name="header">JSFSpy Scoped Data View</ui:define>
    <ui:define name="content">
      <p>
        <f:view>
          <h:form id="columncontrol">
            <h:commandButton id="showAllPhases" 
                             value="Show All Phases" 
                             action="#{spybackingbean.showAllPhases}"
                             rendered="#{!spybackingbean.showAllPhasesFlag}"/>
            <h:commandButton id="showFirstAndLastPhase" 
                             value="Show First and Last Phase" 
                             action="#{spybackingbean.showFirstAndLastPhase}"
                             rendered="#{spybackingbean.showAllPhasesFlag}"/>
          </h:form>
          
          <ui:include src="scopetable.xhtml">
            <ui:param name="scopename" value="Request Scope" />
            <ui:param name="scopevalues" value="#{spybackingbean.requestScopeValues}"/>
          </ui:include>
          
          <f:subview rendered="#{spybackingbean.seamPresent}">
            <ui:include src="scopetable.xhtml" >
              <ui:param name="scopename" value="Seam Conversation Scope" />
              <ui:param name="minornote" value="#{!spybackingbean.showAllPhasesFlag ? 'First and last values are often null for conversation scope. Show all phases to view values.':''}"/>
              <ui:param name="scopevalues" value="#{spybackingbean.conversationScopeValues}"/>
            </ui:include>
          </f:subview>
          
          <ui:include src="scopetable.xhtml">
            <ui:param name="scopename" value="Session Scope" />
            <ui:param name="scopevalues" value="#{spybackingbean.sessionScopeValues}"/>
          </ui:include>
          
          <ui:include src="scopetable.xhtml">
            <ui:param name="scopename" value="Application Scope" />
            <ui:param name="scopevalues" value="#{spybackingbean.applicationScopeValues}"/>
          </ui:include>
          
          <ui:repeat value="#{spybackingbean.customScopeViews}" var="customScopeView">
            <ui:include src="scopetable.xhtml">
              <ui:param name="scopename" value="Custom Scope: #{customScopeView.scopeName}" />
              <ui:param name="scopevalues" value="#{customScopeView.phaseValues}"/>
            </ui:include>
          </ui:repeat>
        </f:view>
      </p>
    </ui:define>
  </ui:composition>
</html>
